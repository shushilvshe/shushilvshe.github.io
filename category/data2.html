<meta property="og:title" content="shushilvshe's Blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://www.shushilvshe.com" />
<meta name="twitter:url" content="http://www.shushilvshe.com" />
<meta itemprop="name" content="shushilvshe's Blog">
<meta itemprop="url" content="http://www.shushilvshe.com">

<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="zh_cn" class="no-js lt-ie9 lt-ie8 lt-ie7" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if IE 7]>         <html lang="zh_cn" class="no-js lt-ie9 lt-ie8" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if IE 8]>         <html lang="zh_cn" class="no-js lt-ie9" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="zh_cn" class="no-js" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/Blog"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Data</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<link rel="shortcut icon" href="http://www.shushilvshe.com/http://www.shushilvshe.com/images/lvcheng.jpg" type="">
<meta name="author" content="ssls">
<meta name="copyright" content="ssls">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta property="og:site_name" content="shushilvshe's Blog" />
<meta property="og:title" content="shushilvshe's Blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://www.shushilvshe.com" />
<meta name="twitter:url" content="http://www.shushilvshe.com" />
<meta itemprop="name" content="shushilvshe's Blog" />
<meta itemprop="url" content="http://www.shushilvshe.com"/>
<link href="http://www.shushilvshe.com/None" type="application/atom+xml" rel="alternate" title="shushilvshe's Blog ATOM Feed"/>
<link href='//fonts.googleapis.com/css?family=Open+Sans:800italic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/uikit.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/components/search.min.css">
<link rel="stylesheet" href="http://www.shushilvshe.com/theme/css/tipuesearch.css">
<link rel="stylesheet" href="http://www.shushilvshe.com/theme/css/solarized.css">
<link rel="stylesheet" href="http://www.shushilvshe.com/theme/css/main.css">

<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
</head>
<body>
<!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

<header class=" mg-header uk-navbar uk-navbar-attached">

    <div class="uk-container uk-container-center">

        <a class="mg-brand uk-navbar-brand uk-hidden-small" href="http://www.shushilvshe.com">shushilvshe's Blog</a>
        <div class="mg-tagline uk-navbar-content uk-hidden-small">Data Developer</div>
        <a class="uk-navbar-toggle uk-visible-small" href="#mg-offcanvas" data-uk-offcanvas></a>
        <a class="mg-brand uk-navbar-brand uk-navbar-center uk-visible-small" href="http://www.shushilvshe.com">shushilvshe's Blog</a>

    </div>
</header>

<main class="mg-main">

<div class="uk-container uk-container-center">

    <div class="uk-grid" data-uk-grid-margin>

<div class="uk-width-medium-4-5">


            <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/data/dl-env-build.html" class="uk-article-title uk-link-muted" itemprop="name">搭建深度学习环境详细过程(Centos7.3+GTX-1080Ti显卡)</a>
                <p class="uk-article-meta"><time datetime="2017-09-22" itemprop="datePublished">2017-09-22(星期五) 16:25</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">在一个由N多台普通的不能再普通的机器攒凑起来的机箱中，搭载了最强核心——NVIDIA GeForce GTX 1080 Ti。我们的深度学习环境搭建之旅，将从如何攒凑这款独一无二的机箱开始，一点一点完成从简单电脑维修装配到逼格爆棚的Deep Learning的华丽丽转身。</p>
                <section itemprop="articleBody"><p><strong>目录：</strong></p>
<p><link rel="stylesheet" href="http://yandex.st/highlightjs/6.2/styles/googlecode.min.css"></p>
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>

<script src="http://yandex.st/highlightjs/6.2/highlight.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript">
 $(document).ready(function(){
      $("h2,h3,h4,h5,h6").each(function(i,item){
        var tag = $(item).get(0).localName;
        $(item).attr("id","wow"+i);
        $("#category").append('<a class="new'+tag+'" href="#wow'+i+'">'+$(this).text()+'</a></br>');
        $(".newh2").css("margin-left",0);
        $(".newh3").css("margin-left",20);
        $(".newh4").css("margin-left",40);
        $(".newh5").css("margin-left",60);
        $(".newh6").css("margin-left",80);
      });
 });
</script>

<div id="category"></div>

<h2>一、安装系统 centos 7.3</h2>
<p>使用 UltraISO 制作的U盘启动盘，镜像使用的是 <a href="https://mirrors.aliyun.com/centos/7.3.1611/isos/x86_64/CentOS-7-x86_64-DVD-1611.iso">CentOS-7-x86_64-DVD-1611.iso</a></p>
<p>安装过程略去。。。</p>
<h2>二、准备显卡及相关驱动</h2>
<h3>硬件准备</h3>
<p>由于<strong>GeForce GTX-1080Ti</strong>需要两个8pin接口供电，且比较耗能，功率为280w，公司没有闲置的能满足需求的大功率电源，即使有的话，8pin的供电的接口一般都不够用（小主板一般为4pin）。最终方案是显卡单独供电，从几个不用的电源上攒出来包含两个8pin（<strong>此8pin接口实为3根黄线和3根黑线，另外两根黑线为黑线接口引线串联起来，见下图</strong>）接口的电源（额定功率为270w），另外一个给机箱主板供电的电源（额定功率270w）除去本身的24pin接口和硬盘供电接口外，再拼接一条8接口（<strong>此8pin实为4根黄线和4根黑线组成</strong>），以弥补供电不足（PS： 电源功率足够大的话阔以忽略以上折腾活儿）。</p>
<p><center><strong>显卡8pin接口</strong></center></p>
<p><center><img src="https://i.imgur.com/bHPRl16.jpg" width="800"/></center></p>
<p><center><strong>主板辅助电源8pin接口</strong></center></p>
<p><center><img src="https://i.imgur.com/TFJdKdS.jpg" width="800"/></center></p>
<p><center><strong>最终机箱全貌</strong></center></p>
<p><center><img src="https://i.imgur.com/soW95T1.jpg" width="800"/></center></p>
<blockquote>
<p>补充：目前主板供电的接口主要有24针与20针两种，在中高端的主板上，一般都采用24PIN的主板供电接口设计，低端的产品一般为20PIN。不论采用24PIN和20PIN，其插法都是一样的 。</p>
</blockquote>
<p><center><img src="https://i.imgur.com/mvKWU5Q.jpg" width="650"/></center></p>
<p>另外随着CPU、显卡等功耗增大，主板上增加了 4pin或8pin 的辅助供电</p>
<p><center><img src="https://i.imgur.com/WJiXcFO.jpg" width="650"/></center></p>
<h3>软件准备</h3>
<p>所需文件一览：</p>
<div class="highlight"><pre><span></span>-rwxr-xr-x 1 root root   97546170 9月  20 10:24 cuda_8.0.61.2_linux-run            cuda补丁      
-rwxr-xr-x 1 root root 1465528129 9月  20 10:27 cuda_8.0.61_375.26_linux-run       cuda8.0驱动  
-rw-r--r-- 1 root root  201134139 9月  20 10:27 cudnn-8.0-linux-x64-v6.0.tgz       cudnn6.0（针对cuda8.0）
-rwxr-xr-x 1 root root   80803084 9月  20 10:27 NVIDIA-Linux-x86_64-384.69.run     NVIDIA驱动
</pre></div>


<h4>1.安装前准备工作</h4>
<ul>
<li>
<p><strong>更新系统（时间较长，耐心等待）</strong></p>
<div class="highlight"><pre><span></span># yum update
# reboot
</pre></div>


</li>
<li>
<p><strong>安装kernel-devel Package</strong></p>
<div class="highlight"><pre><span></span># yum install kernel-devel-$(uname -r) gcc
</pre></div>


</li>
<li>
<p><strong>禁用 nouveau 驱动</strong></p>
<blockquote>
<p>首先说明下什么是Nouveau，为什么有些系统安装N卡驱动的时候会提示“ERROR: The Nouveau kernel driver is currently in use by your system. This Nouveau是由第三方为NVIDIA显卡开发的一个开源3D驱动，也没能得到NVIDIA的认可与支持。虽然Nouveau Gallium3D在游戏速度上还远远无法和NVIDIA官方私有驱动相提并论，不过确让Linux更容易的应对各种复杂的NVIDIA显卡环境，让用户安装完系统即可进入桌面并且有不错的显示效果，所以，很多Linux发行版默认集成了Nouveau驱动，在遇到NVIDIA显卡时默认安装。企业版的Linux更是如此，几乎所有支持图形界面的企业Linux发行版都将Nouveau收入其中。</p>
</blockquote>
<div class="highlight"><pre><span></span># echo &#39;blacklist nouveau&#39; &gt;&gt; /etc/modprobe.d/blacklist.conf
</pre></div>


<p>验证是否成功禁用nouveau，重启后执行如下命令没有输出则没有启用nouveau。</p>
<div class="highlight"><pre><span></span># lsmod | grep nouveau
</pre></div>


<blockquote>
<p><strong>以上方法如果行不通的话，可能的原因是因为系统启动方式不太一样，具体不是特别了解，可采用如下方式禁用 nouveau 驱动：</strong></p>
</blockquote>
<ul>
<li>
<p><strong>Disable X Windows</strong></p>
<div class="highlight"><pre><span></span># sudo systemctl set-default multi-user.target
</pre></div>


</li>
<li>
<p><strong>Remove Nouveau</strong></p>
<div class="highlight"><pre><span></span># sudo rpm -e xorg-x11-drivers xorg-x11-drv-nouveau
</pre></div>


</li>
<li>
<p><strong>Blacklist Nouveau</strong></p>
<p><strong>a)</strong> edit /etc/modprobe.d/blacklist.conf and add line: <code>blacklist nouveau</code><br>
<strong>b)</strong> edit /etc/default/grub and append to GRUB_CMDLINE_LINUX: <code>rdblacklist=nouveau</code> 
(After step 5, if the nouveau driver is still running, try <strong><code>rd.driver.blacklist=nouveau</code></strong> here instead. Sometimes rdblacklist=nouveau fails.)<br>
<strong>-If you have an encrypted root drive, remove "rhgb" from GRUB_CMDLINE_LINUX.</strong>This will allow you to interact with the encryption passphrase prompt, since Plymouth doesn't seem to run without a framebuffer friendly video driver loaded.<br>
<strong>c)</strong> Two options for booting now days are BIOS and EFI (Make sure that /boot and/or /boot/efi are mounted before executing these commands.)<br>
<strong>-If you chose BIOS boot run this command:</strong>
grub2-mkconfig -o /boot/grub2/grub.cfg <br>
<strong>-If EFI boot on CentOS:</strong> 
grub2-mkconfig -o /boot/efi/EFI/centos/grub.cfg<br>
<strong>-If EFI boot on RHEL/Scientific Linux:</strong>
grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg</p>
</li>
<li>
<p><strong>Reboot and Install NVidia Driver</strong> (安装显卡驱动)</p>
</li>
<li>
<p><strong>Enable X Windows (If Desired)</strong> （安装完显卡驱动后执行）</p>
<div class="highlight"><pre><span></span># sudo systemctl set-default graphical.target
# sudo reboot
</pre></div>


</li>
</ul>
</li>
<li>
<p><strong>备份 initramfs 文件（系统内核镜像文件）</strong></p>
<p><strong>initramfs文件初探</strong></p>
<blockquote>
<p>Linux内核在初始化之后会执行init进程，而init进程会挂载我们的根文件系统，但由于init程序也是在根文件系统上的，所以这就有了悖论。Linux采用两步走的方法来解决这个问题。Linux2.6版以前的方法是：除了内核vmlinuz之外还有一个独立的initrd.img映像文件，其实它就是一个文件系统映像，linux内核在初始化后会mount initrd.img作为一个临时的根文件系统，而init进程就是在initrd.img里的，然后init进程会挂载真正的根文件系统，然后umount initrd.img。但Linux2.6内核的实现方式却不太一样，虽然完成的功能是一样的。Linux2.6采用initramfs。initramfs：init ram filesystem，它是一个cpio格式的内存文件系统，制作的方法有两个，一个是http://blog.csdn.net/htttw/article/details/7215858介绍的，但这样做出来的initramfs是和内核vmlinuz分开的，因此我们需要在grub里写上initramfs的路径。而另一种方法是把内核和initramfs制作在一起成为一个文件，方法是在linux源码make menuconfig，然后General setup--&gt;选择Initial RAM filesystem and RAM disk (initramfs/initrd) support，然后在Initramfs source file(s)里输入我们的initramfs目录，然后make bzImage。这种方法做出来的内核就只有一个文件，不需要指定initramfs了。</p>
</blockquote>
<div class="highlight"><pre><span></span># sudo mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak
</pre></div>


</li>
<li>
<p><strong>重建 initramfs 文件（更新系统kernel后正常重启会在/boot目录下自动生成新内核镜像，可选）</strong></p>
<div class="highlight"><pre><span></span># sudo dracut -v /boot/initramfs-$(uname -r).img $(uname -r)
</pre></div>


</li>
<li>
<p><strong>关闭图形界面(如果有VNC服务, 请先关闭vnc服务)，执行</strong></p>
<div class="highlight"><pre><span></span># sudo systemctl disable gdm
# sudo reboot
</pre></div>


</li>
</ul>
<h4>2.安装显卡驱动</h4>
<blockquote>
<p>下载对应型号的 NVidia 驱动，此处下载最新支持 <strong>GTX1080 Ti</strong> 的驱动 <code>NVIDIA-Linux-x86_64-384.69.run</code>。 点击 <a href="http://www.nvidia.com/object/linux-amd64-display-archive.html">官方下载</a>。</p>
</blockquote>
<p><strong>下载完后执行, 按提示选择进行安装：</strong></p>
<div class="highlight"><pre><span></span># ./NVIDIA-Linux-x86_64-384.69.run
</pre></div>


<p><strong>配置X11</strong> (在安装驱动的时候有自动执行 <code>nvidia-xconfig</code> 选项, 如果选yes可以确定跳过此步骤)</p>
<div class="highlight"><pre><span></span># nvidia-xconfig

WARNING: Unable to locate/open X configuration file.

New X configuration file written to &#39;/etc/X11/xorg.conf&#39;
</pre></div>


<p><strong>启动图形界面</strong></p>
<div class="highlight"><pre><span></span># systemctl enable gdm
Created symlink from /etc/systemd/system/display-manager.service to /usr/lib/systemd/system/gdm.service.
# reboot
</pre></div>


<p><strong>验证</strong></p>
<ul>
<li>
<p>执行命令查看显卡状态</p>
<div class="highlight"><pre><span></span># nvidia-smi
</pre></div>


</li>
<li>
<p>在页面右上角的 <strong>应用程序-&gt; 其他 -&gt; Nvidia</strong> 选项中，有如下 <strong>GPU 0</strong> 选项，说明安装成功（<strong>找的样图，型号和驱动不同</strong>）</p>
</li>
</ul>
<p><center><img src="https://i.imgur.com/OlHGtx6.png" width="800"/></center></p>
<blockquote>
<p>【注】： 如果中途有问题, 可以执行 <strong><code>./NVIDIA-Linux-x86_64-384.69.run --uninstall</code></strong> 进行卸载. </p>
</blockquote>
<h4>3.安装cuda</h4>
<p>【<a href="https://developer.nvidia.com/compute/cuda/8.0/Prod2/local_installers/cuda_8.0.61_375.26_linux-run">cuda-8.0驱动下载</a>】  【<a href="https://developer.nvidia.com/compute/cuda/8.0/Prod2/patches/2/cuda_8.0.61.2_linux-run">cuda-8.0补丁下载</a>】 【<a href="https://developer.nvidia.com/cuda-downloads">其他版本驱动下载</a>】</p>
<p>科普下cuda，简单来说就是能使用GPU并行计算的平台和编程模型,能极大提升计算性能。</p>
<blockquote>
<p>Q: What is CUDA?<br>
CUDA® is a parallel computing platform and programming model that enables dramatic increases in computing performance by harnessing the power of the graphics processing unit (GPU). <br>
Since its introduction in 2006, CUDA has been widely deployed through thousands of applications and published research papers, and supported by an installed base of hundreds of millions of CUDA-enabled GPUs in notebooks, workstations, compute clusters and supercomputers.  Applications used in astronomy, biology, chemistry, physics, data mining, manufacturing, finance, and other computationally intense fields are increasing using CUDA to deliver the benefits of GPU acceleration.</p>
</blockquote>
<ul>
<li>
<p>再次进入text mode</p>
<div class="highlight"><pre><span></span># init 3
</pre></div>


</li>
<li>
<p>安装依赖库：</p>
<div class="highlight"><pre><span></span># yum -y install gcc-c++
# yum -y install epel-release
# yum -y install --enablerepo=epel dkms
# yum -y install kernel-devel-$(uname -r) kernel-headers-$(uname -r)
</pre></div>


</li>
<li>
<p>安装cuda-8.0驱动（<strong>一定注意下图安装过程中的红框部分，跳过安装NVIDIA驱动的步骤（输入n）</strong>）：</p>
<div class="highlight"><pre><span></span># ./cuda_8.0.61_375.26_linux-run
</pre></div>


<p><center><img src="https://i.imgur.com/jQ31WeT.png" width="1280"/></center></p>
</li>
<li>
<p>安装cuda补丁</p>
<div class="highlight"><pre><span></span># ./cuda_8.0.61.2_linux-run
</pre></div>


</li>
<li>
<p>设置环境变量</p>
<div class="highlight"><pre><span></span># vim /etc/profile
</pre></div>


<p>最后一行添加</p>
<div class="highlight"><pre><span></span><span class="x">export PATH=&quot;/usr/local/cuda-8.0/bin:</span><span class="p">$</span><span class="nv">PATH</span><span class="x">&quot;</span>
<span class="x">export LD_LIBRARY_PATH=&quot;/usr/local/cuda-8.0/lib64&quot;</span>
<span class="x">export CUDA_HOME=&quot;/usr/local/cuda&quot;</span>
</pre></div>


<p>使之生效</p>
<div class="highlight"><pre><span></span># source /etc/profile
</pre></div>


</li>
</ul>
<h4>4.安装cuDNN</h4>
<p>科普下cudnn，简单点说cuDNN是NVIDIA深度学习中的深层神经网络库，并通过cuda，我们就可以直接利用Nvidia GPU的并行计算能力进行深度学习训练任务了。</p>
<blockquote>
<p>The NVIDIA CUDA® Deep Neural Network library (cuDNN) is a GPU-accelerated library of primitives for deep neural networks. cuDNN provides highly tuned implementations for standard routines such as forward and backward convolution, pooling, normalization, and activation layers. cuDNN is part of the NVIDIA Deep Learning SDK.</p>
</blockquote>
<ul>
<li>
<p>下载cudnn-8.0-linux-x64-v6.0.tgz</p>
<p>下载cuDNN,需要创建一个NVIDIA账号，<a href="https://developer.nvidia.com/cudnn">cuDNN Home Page</a>.</p>
<p>不想注册的话，可以通过如下方式获取</p>
<div class="highlight"><pre><span></span>wget http://developer.download.nvidia.com/compute/redist/cudnn/v6.0/cudnn-8.0-linux-x64-v6.0.tgz
</pre></div>


</li>
<li>
<p>解压并拷贝相关文件，完成安装 </p>
<div class="highlight"><pre><span></span># tar -xzvf cudnn-8.0-linux-x64-v6.0.tgz 
# sudo cp cuda/include/cudnn.h /usr/local/cuda/include
# sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64
# sudo chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn*
</pre></div>


</li>
</ul>
<h2>三、python 3.6.2编译安装及配置</h2>
<h3>1.安装依赖库</h3>
<div class="highlight"><pre><span></span>yum install gcc-c++ sqlite-devel gcc zlib zlib-devel bzip2-devel  openssl-devel ncurses-devel tcl tcl-devel tk tk-devel
</pre></div>


<h3>2.安装Python3</h3>
<p>【<a href="https://www.python.org/ftp/python/3.6.2/Python-3.6.2.tgz">python-3.6.2 源码下载</a>】</p>
<p>将python 源码放置到一个无害的目录,执行命令：</p>
<div class="highlight"><pre><span></span># sudo mkdir /usr/local/python3
# tar -xzvf Python-3.6.2.tgz
# cd Python-3.6.2 # 进入解压目录
# sudo ./configure --prefix=/usr/local/python3  --enable-optimizations # 指定创建的目录
</pre></div>


<p>修改Setup文件</p>
<div class="highlight"><pre><span></span>vim Modules/Setup
</pre></div>


<p>修改结果如下（将行开头的注释“#”去掉）：</p>
<div class="highlight"><pre><span></span><span class="c"># Socket module helper for socket(2)</span>
<span class="err">_socket</span> <span class="err">socketmodule.c</span>

<span class="c"># Socket module helper for SSL support; you must comment out the other</span>
<span class="c"># socket line above, and possibly edit the SSL variable:</span>
<span class="c">#SSL=/usr/local/ssl</span>
<span class="err">_ssl</span> <span class="err">_ssl.c</span> <span class="err">\</span>
<span class="err">-DUSE_SSL</span> <span class="err">-I</span><span class="k">$(</span><span class="nv">SSL</span><span class="k">)</span><span class="err">/include</span> <span class="err">-I</span><span class="k">$(</span><span class="nv">SSL</span><span class="k">)</span><span class="err">/include/openssl</span> <span class="err">\</span>
<span class="err">-L</span><span class="k">$(</span><span class="nv">SSL</span><span class="k">)</span><span class="err">/lib</span> <span class="err">-lssl</span> <span class="err">-lcrypto</span>
</pre></div>


<p>编译安装（时间较长，耐心等待）</p>
<div class="highlight"><pre><span></span>sudo make
sudo make install
</pre></div>


<h3>3.与Python 2.7.5 共存</h3>
<p>创建链接python3，这样就可以通过 python 命令使用 Python 2，python3 来使用 Python 3。</p>
<div class="highlight"><pre><span></span>sudo ln -s /usr/local/python3/bin/python3 /usr/bin/python3
</pre></div>


<p>安装 pip</p>
<div class="highlight"><pre><span></span>sudo ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3
</pre></div>


<p>pip升级 </p>
<div class="highlight"><pre><span></span>pip3 install --upgrade pip
</pre></div>


<h2>四、python机器学习和深度学习库安装</h2>
<h3>1.安装机器学习相关库</h3>
<div class="highlight"><pre><span></span>pip3 install -U wheel

pip3 install -U numpy

pip3 install -U scipy

pip3 install -U matplotlib

pip3 install -U pandas

pip3 install -U scikit-learn

pip3 install -U ipython jupyter notebook

pip3 install -U spyder

pip3 install -U dill
</pre></div>


<h3>2.安装深度学习相关库</h3>
<div class="highlight"><pre><span></span>yum install -y python-numpy python-dev cmake zlib1g-dev libjpeg-dev xvfb libav-tools xorg-dev python-opengl libboost-all-dev libsdl2-dev swig

pip3 install -U h5py

pip3 install -U tensorflow-gpu

pip3 install -U scikit-image

pip3 install -U keras

pip3 install -U keras-rl  # 强化学习(可选)

pip3 install -U keras-vis # 可视化（可选）

pip3 install -U gym[all] （可选，安装时稍微有些麻烦，暂时没用到，未安装）
</pre></div>


<h2>五、jupyter配置</h2>
<h3>1.生成默认配置</h3>
<div class="highlight"><pre><span></span># cd /usr/local/python3/bin
# ./jupyter notebook --generate-config
Writing default config to: /home/user/.jupyter/jupyter_notebook_config.py
</pre></div>


<h3>2.编辑配置文件</h3>
<div class="highlight"><pre><span></span># vim /home/user/.jupyter/jupyter_notebook_config.py

c.NotebookApp.ip = &#39;*&#39;               #所有绑定服务器的IP都能访问
c.NotebookApp.port = 8899            #将端口设置为自己喜欢的吧，默认是8888
c.NotebookApp.open_browser = False   #我们并不想在服务器上直接打开Jupyter Notebook，所以设置成False
c.NotebookApp.notebook_dir = &#39;/data/bigdata/notebooks/&#39;   #设置notebook工作目录
</pre></div>


<h3>3. 设置Jupyter Notebook密码</h3>
<p>在python控制台 ,输入</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">notebook.auth</span> <span class="kn">import</span> <span class="n">passwd</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">passwd</span><span class="p">()</span>

<span class="n">Enter</span> <span class="n">password</span><span class="p">:</span> <span class="o">*******</span>
<span class="n">Verify</span> <span class="n">password</span><span class="p">:</span><span class="o">*******</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="s1">&#39;sha1:67c9e60bb8b6:9ffede0825894254b2e042ea597d771089e11aed&#39;</span>   <span class="c1">#密码密文</span>
</pre></div>


<p>修改配置密码信息</p>
<div class="highlight"><pre><span></span># vim /home/you/.jupyter/jupyter_notebook_config.py

c.NotebookApp.password = u&#39;sha1:67c9e60bb8b6:9ffede0825894254b2e042ea597d771089e11aed&#39;  #注意前面的u
</pre></div>


<h3>4.启动</h3>
<p>设置为开机自启动服务</p>
<div class="highlight"><pre><span></span># cd ~
# mkdir services
# cd services
# vim jupyter.service
</pre></div>


<p>在 jupyter.service 中输入</p>
<div class="highlight"><pre><span></span><span class="k">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">Jupyter notebook env</span>

<span class="k">[Service]</span>
<span class="na">User</span><span class="o">=</span><span class="s">root</span>
<span class="na">Group</span><span class="o">=</span><span class="s">root</span>
<span class="na">Environment</span><span class="o">=</span><span class="s">LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64 #添加此环境变量，避免启动tensorFlow时找不到某些类库</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/usr/local/python3/bin/jupyter notebook --allow-root</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span>
</pre></div>


<p>保存退出</p>
<div class="highlight"><pre><span></span># cp ./jupyter.service /usr/lib/systemd/system/jupyter.service
# ln -s /usr/lib/systemd/system/jupyter.service jupyter.service  #同时修改此两个文件
</pre></div>


<p>开机自启动</p>
<div class="highlight"><pre><span></span># systemctl enable jupyter.service
</pre></div>


<p>启动服务</p>
<div class="highlight"><pre><span></span># systemctl start jupyter.service
</pre></div>


<blockquote>
<p><strong>PS:单独启动一次可通过如下方式（必须在用户目录下, 如/root目录下执行）</strong></p>
</blockquote>
<div class="highlight"><pre><span></span>nohup /usr/local/python3/bin/jupyter notebook --allow-root  &gt;/dev/null 2&gt;&amp;1 &amp;
</pre></div>


<h2>六、测试下环境</h2>
<p>至此，深度学习所用到的环境搭建完成，下面我们就拿训练人脸识别的模型做个测试吧。</p>
<p><center><img src="https://i.imgur.com/UKw9IRt.jpg" width="1280"/></center></p>
<p><strong>bingo，这一天的工作，值了。</strong></p>
<h2>问题</h2>
<h3>1.运行 init 3 报错</h3>
<blockquote>
<p>注意： 如果报如下错误，可能是因为/boot下空间不足了</p>
</blockquote>
<div class="highlight"><pre><span></span>[root@localhost GPU]# init 3

Broadcast message from systemd-journald@localhost.localdomain (Wed 2017-09-20 11:26:40 CST):

dracut[11820]: dracut: creation of /boot/initramfs-3.10.0-693.2.2.el7.x86_64kdump.img failed

Message from syslogd@localhost at Sep 20 11:26:40 ...
 dracut:dracut: creation of /boot/initramfs-3.10.0-693.2.2.el7.x86_64kdump.img failed
</pre></div>


<p>查看/boot 空间</p>
<div class="highlight"><pre><span></span>[root@localhost boot]# df /boot
文件系统        1K-块   已用  可用 已用% 挂载点
/dev/sdb1      255724 253488  2236  100% /boot
</pre></div>


<p>查看老版本的内核版本</p>
<div class="highlight"><pre><span></span>[root@localhost boot]# rpm -qa|grep kernel
kernel-3.10.0-514.26.2.el7.x86_64
kernel-tools-libs-3.10.0-693.2.2.el7.x86_64
kernel-headers-3.10.0-693.2.2.el7.x86_64
kernel-tools-3.10.0-693.2.2.el7.x86_64
kernel-devel-3.10.0-693.2.2.el7.x86_64
kernel-3.10.0-693.2.2.el7.x86_64
kernel-3.10.0-514.el7.x86_64
abrt-addon-kerneloops-2.1.11-48.el7.centos.x86_64
</pre></div>


<p>卸载老版本内核</p>
<div class="highlight"><pre><span></span>[root@localhost boot]# rpm -e kernel-3.10.0-514.el7.x86_64 kernel-3.10.0-514.26.2.el7.x86_64
</pre></div>


<h2>参考</h2>
<blockquote>
<p>https://linuxconfig.org/nvidia-geforce-driver-installation-on-centos-7-linux-64-bit</p>
<p>http://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#redhat-installation</p>
<p>http://www.pyimagesearch.com/2016/07/04/how-to-install-cuda-toolkit-and-cudnn-for-deep-learning</p>
<p>https://www.linkedin.com/pulse/20140808222919-219659043-rhel-centos-7-and-nvidia-drivers</p>
</blockquote></section>
                <a href="http://www.shushilvshe.com/data/dl-env-build.html#disqus_thread"></a>
                <hr class="uk-article-divider">
            </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/data/keras.html" class="uk-article-title uk-link-muted" itemprop="name">keras资源设置</a>
                <p class="uk-article-meta"><time datetime="2017-09-13" itemprop="datePublished">2017-09-13(星期三) 14:00</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">keras资源设置</p>
                <p>1.关闭GPU，只使用CPU 在import tensorflow之前，加上： import os os.environ["CUDA_DEVICE_ORDER"] = "PCI_BUS_ID" # see issue #152 os.environ["CUDA_VISIBLE_DEVICES"] = "" 2.设置keras占用GPU内存的比例： import os import tensorflow as tf import keras.backend.tensorflow_backend as K def get_session(gpu_fraction=0.3): '''Assume that you have 6GB of GPU memory and want to allocate...</p>
                <a href="http://www.shushilvshe.com/data/keras.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/data/cnn.html" class="uk-article-title uk-link-muted" itemprop="name">卷积神经网络（CNN）</a>
                <p class="uk-article-meta"><time datetime="2017-09-13" itemprop="datePublished">2017-09-13(星期三) 13:59</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">卷积神经网络(Convolutional Neural Network, CNN)是深度学习技术中极具代表的网络结构之一，在图像处理领域取得了很大的成功，在国际标准的ImageNet数据集上，许多成功的模型都是基于CNN的。CNN相较于传统的图像处理算法的优点之一在于，避免了对图像复杂的前期预处理过程（提取人工特征等），可以直接输入原始图像。</p>
                <p>概述 卷积神经网络(Convolutional Neural Network, CNN)是深度学习技术中极具代表的网络结构之一，在图像处理领域取得了很大的成功，在国际标准的ImageNet数据集上，许多成功的模型都是基于CNN的。CNN相较于传统的图像处理算法的优点之一在于，避免了对图像复杂的前期预处理过程（提取人工特征等），可以直接输入原始图像。 图像处理中，往往会将图像看成是一个或多个的二维向量，如之前博文中提到的MNIST手写体图片就可以看做是一个28 × 28的二维向量（黑白图片，只有一个颜色通道；如果是RGB表示的彩色图片则有三个颜色通道，可表示为三张二维向量）。传统的神经网络都是采用全连接的方式，即输入层到隐藏层的神经元都是全部连接的，这样做将导致参数量巨大，使得网络训练耗时甚至难以训练，而CNN则通过局部连接、权值共享等方法避免这一困难，有趣的是，这些方法都是受到现代生物神经网络相关研究的启发（感兴趣可阅读以下部分）。 卷积神经网络(CNN)的出现是为了解决MLP多层感知器全连接和梯度发散的问题，其核心思想：1.局部感知(local field)，2.权值共享(Shared Weights)，3.下采样(池化)(subsampling)。极大地提升了计算速度，减少了连接数量。 局部连接与权值共享 下图是一个很经典的图示，左边是全连接，右边是局部连接。 对于一个1000 × 1000的输入图像而言，如果下一个隐藏层的神经元数目为10^6个，采用全连接则有1000 × 1000 × 10^6 = 10^12个权值参数，如此数目巨大的参数几乎难以训练；而采用局部连接，隐藏层的每个神经元仅与图像中10 × 10的局部图像相连接，那么此时的权值参数数量为10 × 10 × 10^6 = 10^8，将直接减少4个数量级。 尽管减少了几个数量级，但参数数量依然较多。能不能再进一步减少呢？能！方法就是权值共享。具体做法是，在局部连接中隐藏层的每一个神经元连接的是一个10 × 10的局部图像，因此有10 × 10个权值参数，将这10 × 10个权值参数共享给剩下的神经元，也就是说隐藏层中10^6个神经元的权值参数相同，那么此时不管隐藏层神经元的数目是多少，需要训练的参数就是这 10 × 10个权值参数（也就是卷积核(也称滤波器)的大小），如下图。 这大概就是CNN的一个神奇之处，尽管只有这么少的参数，依旧有出色的性能。但是，这样仅提取了图像的一种特征，如果要多提取出一些特征，可以增加多个卷积核，不同的卷积核能够得到图像的不同映射下的特征，称之为Feature Map。如果有100个卷积核，最终的权值参数也仅为100 × 100 = 10^4个而已。另外，偏置参数也是共享的，同一种滤波器共享一个。 下面的动图能够更好地解释卷积过程： 池化 在卷积神经网络中，没有必要一定就要对原图像做处理，而是可以使用某种“压缩”方法，这就是池化，也就是每次将原图像卷积后，都通过一个下采样的过程，来减小图像的规模。 pooling的好处： - 1. 这些统计特征能够有更低的维度，减少计算量。 - 2. 不容易过拟合，当参数过多的时候很容易造成过度拟合。 - 3. 缩小图像的规模，提升计算速度。 如下图所示，原图是一张500∗500 的图像，经过subsampling之后哦，变成了一张 250∗250 的图像。这样操作的好处非常明显，虽然经过权值共享和局部连接后的图像权值参数已经大大减少，但是对于计算量来说，还是非常巨大，需要消费很大的计算时间，于是为了进一步减少计算量，于是加入了subsampling这个概念，不仅仅使图像像素减少了， 同时也减少计算时间。 池化规模一般为2×2。常用的池化方法有： 最大池化（Max Pooling）。取4个点的最大值。这是最常用的池化方法。 均值池化（Mean Pooling）。取4个点的均值。 可训练池化。训练函数 f ，接受4个点为输入，出入1个点。 由于特征图的变长不一定是2的倍数，所以在边缘处理上也有两种方案： 保留边缘。将特征图的变长用0填充为2的倍数，然后再池化。 忽略边缘。将多出来的边缘直接省去。 经典网络——LeNet-5网络详解 经典的LeNet-5 网络图 C1层是一个卷积层，由6个特征图Feature Map构成。特征图中每个神经元与输入为5*5的邻域相连。特征图的大小为28*28，这样能防止输入的连接掉到边界之外（32-5+1=28）。C1有156个可训练参数（每个滤波器5*5=25个unit参数和一个bias参数，一共6个滤波器，共(5*5+1)*6=156个参数），共156*(28*28)=122,304个连接。 S2层是一个下采样层，有6个14*14的特征图。特征图中的每个单元与C1中相对应特征图的2*2邻域相连接。S2层每个单元的4个输入相加，乘以一个可训练参数，再加上一个可训练偏置。每个单元的2*2感知机并不重叠，因此S2中每个特征图的大小是C1中特征图大小的1/4（行和列各1/2）。S2层有12（6*（1+1）=12）个可训练参数和5880（14*14*（2*2+1）*6=5880）个连接。 C3层也是一个卷积层，它同样通过5x5的卷积核去卷积层S2，然后得到的特征map就只有10x10个神经元，但是它有16种不同的卷积核，所以就存在16个特征map了。 C3中每个特征图由S2中所有6个或者几个特征map组合而成。为什么不把S2中的每个特征图连接到每个C3的特征图呢？原因有2点。第一，不完全的连接机制将连接的数量保持在合理的范围内。第二，也是最重要的，其破坏了网络的对称性。由于不同的特征图有不同的输入，所以迫使他们抽取不同的特征（希望是互补的）。 例如，存在的一个方式是：C3的前6个特征图以S2中3个相邻的特征图子集为输入。接下来6个特征图以S2中4个相邻特征图子集为输入。然后的3个以不相邻的4个特征图子集为输入。最后一个将S2中所有特征图为输入。这样C3层有1516（6*（3*25+1）+6*（4*25+1）+3*（4*25+1）+（25*6+1）=1516）个可训练参数和151600（10*10*1516=151600）个连接。 S4层是一个下采样层，由16个5*5大小的特征图构成。特征图中的每个单元与C3中相应特征图的2*2邻域相连接，跟C1和S2之间的连接一样。S4层有32个可训练参数（每个特征图1个因子和一个偏置16*（1+1）=32）和2000（16*（2*2+1）*5*5=2000）个连接。 <img...</p>
                <a href="http://www.shushilvshe.com/data/cnn.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/data/python-base.html" class="uk-article-title uk-link-muted" itemprop="name">python常用功能总结</a>
                <p class="uk-article-meta"><time datetime="2017-09-06" itemprop="datePublished">2017-09-06(星期三) 10:09</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">python常用功能总结</p>
                <p>目录： hljs.initHighlightingOnLoad(); $(document).ready(function(){ $("h2,h3,h4,h5,h6").each(function(i,item){ var tag = $(item).get(0).localName; $(item).attr("id","wow"+i); $("#category").append(''+$(this).text()+''); $(".newh2").css("margin-left",0); $(".newh3").css("margin-left",20); $(".newh4").css("margin-left",40); $(".newh5").css("margin-left",60);...</p>
                <a href="http://www.shushilvshe.com/data/python-base.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/data/facealign.html" class="uk-article-title uk-link-muted" itemprop="name">人脸识别——对齐算法</a>
                <p class="uk-article-meta"><time datetime="2017-09-05" itemprop="datePublished">2017-09-05(星期二) 22:24</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">使用facenet框架，可以识别出一张图片中的人脸头像，并返回每张人脸的边界和五官坐标，但图片中有的头像是有倾斜角度的，我们将倾斜度数小于指定阈值的进行校正，其余的按原形截取图片。</p>
                <p>基本思路： 使用facenet框架，可以识别出一张图片中的人脸头像，并返回每张人脸的边界和五官坐标，但图片中有的头像是有倾斜角度的，我们将倾斜度数小于指定阈值的进行校正，其余的按原形截取图片。 倾斜度数根据两只眼睛的坐标加以计算； 缩放比为两眼X坐标与两眼之间的距离比值； 将人脸边界大小分别向四个方向扩充对应边的1/4长，也就是两边界长宽扩为1.5倍/缩放比； 截取扩充的区域，然后以鼻子坐标为中心进行旋转（也可以考虑以左眼为中心旋转，但以有效数据的中点进行旋转可降低扩充的面积）； 旋转后鼻子的X、Y坐标为原坐标减左边界和上边界； 旋转后需要根据两眼和鼻子构成的三角形算出旋转后左眼的坐标，用于最后截图中心点的定位（根据余弦定理和勾股定理计算）； 根据两眼的斜率和人脸边界大概可以计算两眼连线之上有效高度，用于确定最后图片上边界（默认认为脸长大于脸宽）； 脸的长度根据人脸边界/斜率得出大概值（偏小）； 总的图片高度根据计算出的脸长和margin值相加得来； 根据左眼坐标和图片高度计算最后截图需要的四个边界值，得到最后需要图，最后进行缩放完成。 算法实现： import facenet import math from PIL import Image def alignFace(self, image, boundingBoxes, positions, cropSize=160, angleThreshold=5): ''' image 原始图像 boundingBoxes 脸部轮廓边框 positions 五官坐标 cropSize：最后保留的图像的大小 angleThreshold: 旋转头像倾斜角度阈值 ''' aligneds=[] if len(<span...</p>
                <a href="http://www.shushilvshe.com/data/facealign.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/python/peewee.html" class="uk-article-title uk-link-muted" itemprop="name">peewee 入门教程</a>
                <p class="uk-article-meta"><time datetime="2017-08-31" itemprop="datePublished">2017-08-31(星期四) 20:04</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">peewee是一款轻量级、丰富的ORM（Object Relation Mapping，对象关系映射），支持 postgresql、mysql 和 sqlite。</p>
                <p>简介 peewee是一款轻量级、丰富的ORM（Object Relation Mapping，对象关系映射），支持 postgresql、mysql 和 sqlite。 大量的插件支持： Postgresql HStore，Json，Arrays SQLite全文搜索、自定义函数、虚拟表格 结构迁移和model代码生成器 连接池 加密 连表查 单表原生sql接口 模型定义 模型类、字段以及模型实例与数据的对于关系： peewee 数据库 Model class Database table Field instance Column on a table Model instance Row in a database table 开始一个peewee的项目时，通常最好通过定义一个或多个 Model classes: 来开始你的数据模型。 连接数据库 from peewee import * db = SqliteDatabase('people.db') class Person(Model): name = CharField() birthday = DateField() is_relative = BooleanField()...</p>
                <a href="http://www.shushilvshe.com/python/peewee.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/ge-ren-bo-ke-da-jian-guo-cheng-pelicangithub.html" class="uk-article-title uk-link-muted" itemprop="name">个人博客搭建过程(Pelican+Github)</a>
                <p class="uk-article-meta"><time datetime="2017-08-12" itemprop="datePublished">2017-08-12(星期六) 18:44</time> • <a href="http://www.shushilvshe.com/category/data.html">data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">当初整vps完全只是为了科学上网，但感觉一个服务器只运行一个vps服务有点太浪费了，为了让其发挥最大价值，于是就想在上面搭个博客，搞个备份，SVN啥的。所以就先尝试的搭个个人博客系统。一直都想拥有一个只属于自己的博客系统，记录一下生活工作的点点滴滴。尝试过网易、csdh等平台的博客，虽然方便点，但一直没能坚持下来，总觉得不是自己的地盘，一成不变的界面不是我想要的；也尝试过著名的PHP博客系统wordpress,但其对markdown语法支持不太好，再一个比较重要的原因就是我买的vps是最小版的，只有512M内存，养不起这只大猫。。。。。。</p>
                <p>前言 当初整vps完全只是为了科学上网，但感觉一个服务器只运行一个vps服务有点太浪费了，为了让其发挥最大价值，于是就想在上面搭个博客，搞个备份，SVN啥的。所以就先尝试的搭个个人博客系统。一直都想拥有一个只属于自己的博客系统，记录一下生活工作的点点滴滴。尝试过网易、csdh等平台的博客，虽然方便点，但一直没能坚持下来，总觉得不是自己的地盘，一成不变的界面不是我想要的；也尝试过著名的PHP博客系统wordpress,但其对markdown语法支持不太好，再一个比较重要的原因就是我买的vps是最小版的，只有512M内存，养不起这只大猫，有一次只是加了一个图片管理的插件，导致内存爆满，正常的VPS服务都无法使用了，遂只能移情别恋了；告别了动态语言博客系统，一个简洁带有原始风味的静态博客系统进入我的视野——hexo，不过不太喜欢hexo的这种组织风格（PS：也许是我还没研究透彻），最终，我将目光锁定在基于python语言的Pelican博客系统上，原因如下： 对Markdown语法支持比较好，方便编程习惯写博客 正在用python研究ML，python版的博客系统正合适 易安装，主题、插件丰富，文档比较完善，社区比较活跃 页面可托管到github上，有版本管理，且可写个脚本一键生成静态页面并部署，简单快捷 网站组织结构可根据自己组要自定义，自由度高 Pelican是一个用Python语言编写的静态网站生成器，支持使用 restructuredText 和 Markdown 写文章，配置灵活，扩展性强，有许多优秀的主题和插件可供使用。Pelican 的Github地址是：https://github.com/getpelican/pelican;pelican官网：http://blog.getpelican.com/;pelican文档：http://docs.getpelican.com/en/stable/ 所需工具一览 MarkdownPad2（md工具） Pelican（基于Python语言的静态博客框架） Github(静态网页托管) Namesilo(https://www.namesilo.com/) 域名（优惠码） BandwagonHost(搬瓦工——VPS) https://bandwagonhost.com/ （【购买页面（需翻墙）】 【国内】） SecureCRT（ssh工具） shell脚本 我现在的整个操作流程是酱紫滴： 在本地用markdown写博客，之后把md文件同步到云服务器上，在服务器上生成静态页面并提交到github上完成部署，这样有个好处就是可以在家写生活，在公司写工作，两个地方写完之后提交到同一个生成部署环境中即可，不用都部署pelican环境了，适用于经常变换电脑的宝宝们。当然如果用的电脑只有一个的话，完全可以把生成部署环境搭建到本地，本地编辑完，生成再部署即可，这样更简单。 1.准备VPS（或云服务器）(可选) 打开 搬瓦工的购买页面（需翻墙） 国内可从 搬瓦工 购买， 也比较靠谱（我的优惠码是从这儿搞的） 选择最低配的年付 $19.99 的电信联通直连的套餐即可，速度还阔以，有一点不太好就是只有一个DC，不能切换机房 可以从 国内搬瓦工 获取优惠码，有5%的折扣 国内可以选择支付宝付款 开通完毕一般是即时生效的，这时候我们就可以打开网站的管理界面了KiwiVM, 第一步，选择一下自己喜欢的系统重装一下,左侧列表 Install New OS（PS： 由于VPS只能装到centos 6的系统上，所以，没得选） 第二步，安装 VPS 服务 ，左侧列表 Shadowsocks Server 还差最后一步就阔以科学上网了，按如下步骤在本地下载一个shadowsocks，按照图片所示内容填写即可，支持多客户端同时科学上网，棒棒哒✌ 2.github pages绑定独立域名（可选） 拥有一个属于自己的域名感觉逼格很高，无所谓的可以跳过，直接用github的二级域名即可 购买域名 我选用的是namesilo域名服务商，选择namesilo的原因很简单： Namesilo商家的优势在于域名价格比较稳定，其次就是赠送隐私保护。这域名隐私保护还是比较重要的，可以防止个人信息被恶意邮件或者泄露身份. 打开网址 https://www.namesilo.com/ 注册后输入自己想要的域名 点击查询后会显示不同域名后缀价格,选择一个购买就行。 域名管理界面 绑定域名 （注册github帐号以及添加仓库等操作略。。。） 在仓库的配置页面找到 GitHub Pages 配置项，在 Custom domain 中填入刚才注册的域名，点击保存即可。 这时候，会在仓库根目录下生成一个CNAME文件，接下来还需要做的就是去刚Namesilo中配置下ip和域名的映射记录即可。在Namesilo的域名管理界面，找到Github的配置模版 点击 Apply Template , 然后点击 Accecpt， 配置好对应 github页面的地址即可，...</p>
                <a href="http://www.shushilvshe.com/ge-ren-bo-ke-da-jian-guo-cheng-pelicangithub.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/ml/pandas/baseoperation.html" class="uk-article-title uk-link-muted" itemprop="name">pandas基本操作</a>
                <p class="uk-article-meta"><time datetime="2017-08-08" itemprop="datePublished">2017-08-08(星期二) 17:17</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">在pandas中有两类非常重要的数据结构，即序列Series和数据框DataFrame。Series类似于numpy中的一维数组，除了通吃一维数组可用的函数或方法，而且其可通过索引标签的方式获取数据，还具有索引的自动对齐功能；DataFrame类似于numpy中的二维数组，同样可以通用numpy数组的函数和方法，而且还具有其他灵活应用，后续会介绍到。</p>
                <p>1.数据结构介绍 在pandas中有两类非常重要的数据结构，即序列Series和数据框DataFrame。Series类似于numpy中的一维数组，除了通吃一维数组可用的函数或方法，而且其可通过索引标签的方式获取数据，还具有索引的自动对齐功能；DataFrame类似于numpy中的二维数组，同样可以通用numpy数组的函数和方法，而且还具有其他灵活应用，后续会介绍到。 Series的创建 序列的创建主要有三种方式： 1、通过一维数组创建序列 import numpy as np, pandas as pd arr1 = np.arange(10) print(arr1) print(type(arr1)) s1 = pd.Series(arr1) print(s1) print(type(s1)) 显示： [0 1 2 3 4 5 6 7 8 9] <class 'numpy.ndarray'> 0 <span...</p>
                <a href="http://www.shushilvshe.com/ml/pandas/baseoperation.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/ml/dt.html" class="uk-article-title uk-link-muted" itemprop="name">决策树原理</a>
                <p class="uk-article-meta"><time datetime="2017-07-28" itemprop="datePublished">2017-07-28(星期五) 14:03</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">决策树就是做出一个树状决策,就像猜猜看(Twenty Questions)的游戏。一个玩家(先知)选择一种常见物品, 但是事先不能透露给其他玩家(提问者)。提问者最多问20个问题,而先知只能回答: 是, 否, 可能三种答案。提问者的提问会根据先知的回答越来越具体, 多个问题问完后, 提问者的决策就形成了一颗决策树。决策树的分支由可以猜出响应变量值的最短的解释变量序列构成。因此, 在猜猜看游戏中,提问者和先知对训练集的解释变量和响应变量都很了解, 但是只有先知知道测试集的响应变量值。</p>
                <p>决策树简介 决策树就是做出一个树状决策,就像猜猜看(Twenty Questions)的游戏。一个玩家(先知)选择一种常见物品, 但是事先不能透露给其他玩家(提问者)。提问者最多问20个问题,而先知只能回答: 是, 否, 可能三种答案。提问者的提问会根据先知的回答越来越具体, 多个问题问完后, 提问者的决策就形成了一颗决策树。决策树的分支由可以猜出响应变量值的最短的解释变量序列构成。因此, 在猜猜看游戏中,提问者和先知对训练集的解释变量和响应变量都很了解, 但是只有先知知道测试集的响应变量值。 决策树通常是重复的将训练集解释变量分割成子集的过程, 如下图所示。决策树的节点用方块表示, 用来测试解释变量。每个节点向下的边表示不同决策产生结果。训练集的样本由决策结果分成不同的子集。例如, 一个节点测试解释变量的值是否超过的限定值。如果没有超过, 则进入该节点的右侧子节点; 如果超过, 则进入左侧子节点。子节点的运行原理和前面的一样, 直到终止条件(stopping criterion)满足才停止。在分类任务中, 包含在叶子节点中的样本响应变量的值的平均值作为响应变量的估计值。决策树建立之后, 做决策的过程就是把测试样本放进决策树沿着边不断前进, 直到一个叶子被触及才停止前进。 训练决策树 我们用Ross Quinlan发明的ID3(Iterative Dichotomiser 3,迭代二叉树3代)算法创建决策树, ID3是最早用于决策树的算法之一。假设你有一些猫和狗的分类数据。但是不允许直接观察, 你只能通过动物特征的描述去做决策。对每个动物, 你都会获得关于“是否喜欢玩球(play fetch)”和“是否经常发脾气”, 以及它最喜欢的食物三个问题的答案。 要正确分出新动物的种类, 决策树需要对每条边的解释变量进行检查。每条边的下一个节点由测试结果决定。例如, 第一关节点可能问“是否喜欢玩球”, 如果回答“YES”, 则进入左节点, 否则, 如果回答“NO”, 则进入右节点。以此类推, 最后一条边会指向一个叶子节点, 那就是答案。下表是14个节点的训练数据: 从数据中我们发现, 猫比狗更容易发脾气。大多数狗玩球, 而猫不爱玩。狗更喜欢狗粮和培根, 而猫喜欢猫粮和培根。解释变量是否喜欢玩球和是否经常发脾气可以转换成二元特征值。解释变量最喜欢的食物可以转换成一个具有三个可能值的分类变量, 可以用onehot编码[1,0,0], [0,1,0], [0,0,1]表示, 具体方法在第三章已经介绍过。通过上面的分析, 我们可以构建模型的规则。例如,一个动物如果经常发脾气且喜欢吃猫粮那就是猫, 如果喜欢玩球且爱吃培根就是狗。在这么小的训练集里, 想手工逐条构建规则也是非常麻烦的事情。因此, 下面我们来构建决策树。 熵 和猜猜看一样,决策树也是通过对解释变量序列的逐条测试获取响应变量结果的。那么,哪个解释变量应该先测试?直觉观察会发现,解释变量集合包含所有猫或者所有狗的测试,比既包含猫又包含狗的解释变量集合的测试要好。如果子集成员种类不同,我们还是不能确定种类。我们还需要避免创建那种测试,把单独的一只猫或一条狗分离出去,这种做法类似于猜猜看问题中前几轮就问非常具体的问题。更一般的情形是,这些测试极少可以分出一个样本的种类,也不能降低分类不确定性。能够降低分类不确定性的测试通常都是最好的测试。我们通常用熵(entropy)来度量信息的不确定性。以比特(bits)为计量单位,熵量化了一个变量的不确定性。熵计算公式如下所示: 其中, n是样本的数量, P(xi)是第i个样本的概率。 b一般取2, e或10 。因为对数函数中真数小于1则对数值为0, 因此, 公式前面加符号使熵为正数。 例如, 一个硬币投掷一次事件发生后一般有两种可能: 正面或反面。正面朝上的概率是0.5, 反面朝上的概率也是0.5。那么一个硬币投掷一次的结果这个变量的熵: 也就是说,...</p>
                <a href="http://www.shushilvshe.com/ml/dt.html">Read More</a>
                <hr class="uk-article-divider">
        </article>


        <article class="uk-article" itemtype="http://schema.org/BlogPosting" itemscope="itemscope" itemprop="blogPost">
                <a href="http://www.shushilvshe.com/ml/data-proprecess.html" class="uk-article-title uk-link-muted" itemprop="name">数据处理中的数值初步转换</a>
                <p class="uk-article-meta"><time datetime="2017-07-26" itemprop="datePublished">2017-07-26(星期三) 16:04</time> • <a href="http://www.shushilvshe.com/category/data.html">Data</a></p>
</p>
                <p class="uk-article-lead" itemprop="description">我们使用scikit learn进行建模预测， 而SK中的模型都只能处理数值型的数据，需要将原始的字符串类型的数据转为数值型数据。所有数据通常可以分成两种类型：定量与定性。定量的属性（数值属性）通常蕴涵着可排序性，比如在泰坦尼克号数据集中，年龄就是一个定量属性。定性属性（标称 序数 二元属性）的值是一些符号或事务的名称，每个值代表某种类别编码或状态，不是可测量量，是不具有排序意义的，比如Embarked(登船地点)。</p>
                <p>分析基于kaggle-Titanic数据集 我们使用scikit learn进行建模预测， 而SK中的模型都只能处理数值型的数据，需要将原始的字符串类型的数据转为数值型数据。所有数据通常可以分成两种类型：定量与定性。定量的属性（数值属性）通常蕴涵着可排序性，比如在泰坦尼克号数据集中，年龄就是一个定量属性。定性属性（标称 序数 二元属性）的值是一些符号或事务的名称，每个值代表某种类别编码或状态，不是可测量量，是不具有排序意义的，比如Embarked(登船地点)。 1.定性属性的数据变换 对于字符串型的定性属性转换，如果单纯的用数字来代替的化，比如对于Embarked的三个值S Q C分别用1 2 3来代替，模型会把它当成是有顺序的数值属性，对于一些根据距离来确定分类的算法来说，就不能准确运行啦。那么应该怎么将定性属性转为数字呢？ dummy varibles(不知道中文应该说成啥。。虚设属性？) 什么是dummy呢，举个栗子，Emarked属性的取值有三个S Q C，分别代表三个上船地点。dummy这个属性呢，就是向数据集里再加入三个属性暂且命名为Embarked_S Embarkde_Q 和Embarked_C，如果一个人是在S地点上船的，那么这三个属性的值就是（1，0，0），在Q点上船的就是（0，1，0），每个属性都是二元属性，1代表是，0代表否。所以dummy适用于值范围相对较少的属性。 import pandas as pd #creat dummy varibles from raw data dummies_df = pd.get_dummies(df.Embarked) #remana the columns to Embarked_S... dummies_df = dummies_df.rename(columns=lambda x:'Embarked_'+str(x)) df = pd.concat([df,<span...</p>
                <a href="http://www.shushilvshe.com/ml/data-proprecess.html">Read More</a>
                <hr class="uk-article-divider">
        </article>

    <ul class="uk-pagination">
<li><a href="http://www.shushilvshe.com/category/data.html"><i class="uk-icon-angle-double-left"></i></a></li><li><a href="http://www.shushilvshe.com/category/data.html">1</a></li>        <li class="uk-active"><span>2</span></li>
<li><a href="http://www.shushilvshe.com/category/data3.html"><i class="uk-icon-angle-double-right"></i></a></li><li><a href="http://www.shushilvshe.com/category/data3.html">3</a></li>    </ul>

</div>

        <div class="uk-width-medium-1-5 uk-hidden-small">

            <div class="uk-panel uk-panel-box">
                <form class="uk-search" action="search.html" data-uk-search>
                    <input class="uk-search-field tipue_search" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
                </form>
            </div>

            <div class="uk-panel uk-panel-box">
                <ul class="uk-nav uk-nav-side">
                    <li class="uk-nav-header">Categories</li>
                    <li class="uk-active"><a href="http://www.shushilvshe.com/category/data.html">Data</a></li>
                    <li ><a href="http://www.shushilvshe.com/category/food.html">food</a></li>
                    <li ><a href="http://www.shushilvshe.com/category/travel.html">travel</a></li>
                    <li class="uk-nav-header">Pages</li>

                    <li >
                        <a href="http://www.shushilvshe.com/pages/about.html">About ME</a>
                    </li>


                    <li class="uk-nav-divider"></li>
                    <li ><a href="http://www.shushilvshe.com/archives.html">Archives</a></li>
                </ul>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">Receive Updates</h3>
                <a rel="alternate" type="application/atom+xml" href="http://www.shushilvshe.com/None" class="mg-feed"><i class="uk-icon-rss uk-icon-medium"></i> ATOM</a>
            </div>


        </div>

    </div>

</div>

</main>

<footer class="mg-footer">
    <div class="uk-container uk-container-center uk-text-center">

        <div class="mg-icons-small uk-subnav uk-visible-small">
            <li><a rel="alternate" type="application/atom+xml" href="http://www.shushilvshe.com/None" class="uk-icon-button uk-icon-rss"></a></li>
        </div>

        <div class="mg-author uk-panel">
            <p></p>

            <p>Powered by <a href="http://blog.getpelican.com">Pelican</a>.<br class="uk-visible-small"> Theme <a href="https://github.com/lucachr/pelican-mg">mg</a> by <a href="https://github.com/lucachr">Luca Chiricozzi</a>.</p>
        </div>
    </div>
</footer>

<div id="mg-offcanvas" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">

        <form class="uk-search" action="search.html" data-uk-search>
            <input class="uk-search-field" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
        </form>

        <ul class="uk-nav uk-nav-offcanvas" data-uk-nav>
            <li class="uk-nav-header">Categories</li>
            <li class="uk-active"><a href="http://www.shushilvshe.com/category/data.html">Data</a></li>
            <li ><a href="http://www.shushilvshe.com/category/food.html">food</a></li>
            <li ><a href="http://www.shushilvshe.com/category/travel.html">travel</a></li>
            <li class="uk-nav-header">Pages</li>
            <li >
                <a href="http://www.shushilvshe.com/pages/about.html">About ME</a>
            </li>


            <li class="uk-nav-divider"></li>
            <li><a href="http://www.shushilvshe.com/">Archives</a></li>
        </ul>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/uikit.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/components/search.min.js"></script>
<script src="http://www.shushilvshe.com/theme/js/tipuesearch_set.js"></script>
<script src="http://www.shushilvshe.com/theme/js/tipuesearch.js"></script>
<script src="http://www.shushilvshe.com/theme/js/jquery.sticky-kit.js"></script>
<script src="http://www.shushilvshe.com/theme/js/plugins.js"></script>
<script src="http://www.shushilvshe.com/theme/js/main-search.js"></script>



</body>
</html>
